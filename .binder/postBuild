#!/bin/bash

# Binder post-build script for cross-modal head nod analysis
# Most setup is now handled by the Dockerfile using rocker/binder

echo "ðŸ”§ Final Binder setup for Cross-Modal Head Nod Analysis..."

# Make R scripts executable (if needed)
chmod +x *.R
chmod +x scripts/*.R 2>/dev/null || true

# Verify environment
echo "âœ… Rocker/Binder environment ready!"
echo "ï¿½ Cross-modal head nod analysis environment configured"

# Test key packages
R --vanilla -e "
cat('ðŸ§ª Testing key packages...\n')
packages <- c('tidyverse', 'lme4', 'rstatix')
for (pkg in packages) {
  if (requireNamespace(pkg, quietly = TRUE)) {
    cat('âœ…', pkg, 'available\n')
  } else {
    cat('âŒ', pkg, 'missing\n')
  }
}
cat('ðŸŽ‰ Environment ready for analysis!\n')
"

# Test repository functionality
echo "ðŸ§ª Testing repository..."
Rscript -e "options(repos = c(CRAN = 'https://cran.rstudio.com/')); source('test_repository.R')"

echo "âœ… Binder environment setup complete!"
echo "ðŸš€ Ready to run Cross-Modal Head Nod Analysis!"

# Enable RStudio by default
echo "ðŸ“Š Starting with RStudio interface..."
